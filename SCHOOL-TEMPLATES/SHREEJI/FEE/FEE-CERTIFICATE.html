<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SHREEJI || FEE CERTIFICATE</title>
  </head>
  <body>
    <div id="studentsList">Student Fee</div>
    <script>
      window.SetTemplateData = function (dataList) {
        const multipleStudents = dataList;

        //number to words
        function convertNumberToWords(number) {
          const units = [
            "",
            "ONE",
            "TWO",
            "THREE",
            "FOUR",
            "FIVE",
            "SIX",
            "SEVEN",
            "EIGHT",
            "NINE",
          ];
          const teens = [
            "TEN",
            "ELEVEN",
            "TWELVE",
            "THIRTEEN",
            "FOURTEEN",
            "FIFTEEN",
            "SIXTEEN",
            "SEVENTEEN",
            "EIGHTEEN",
            "NINETEEN",
          ];
          const tens = [
            "",
            "",
            "TWENTY",
            "THIRTY",
            "FORTY",
            "FIFTY",
            "SIXTY",
            "SEVENTY",
            "EIGHTY",
            "NINETY",
          ];

          function convertChunk(chunk) {
            let words = "";

            if (chunk >= 100) {
              words += units[Math.floor(chunk / 100)] + " HUNDRED";
              chunk %= 100;

              if (chunk > 0) {
                words += " ";
              }
            }

            if (chunk >= 10 && chunk < 20) {
              words += teens[chunk - 10];
            } else if (chunk >= 20) {
              words += tens[Math.floor(chunk / 10)];

              if (chunk % 10 > 0) {
                words += " " + units[chunk % 10];
              }
            } else if (chunk > 0) {
              words += units[chunk];
            }

            return words;
          }

          if (number === 0) {
            return "RUPEES ZERO ONLY";
          }

          const crore = Math.floor(number / 10000000);
          const lakh = Math.floor((number % 10000000) / 100000);
          const thousand = Math.floor((number % 100000) / 1000);
          const remainder = number % 1000;

          let result = "";

          if (crore > 0) {
            result += convertChunk(crore) + " CRORE ";
          }

          if (lakh > 0) {
            result += convertChunk(lakh) + " LAKH ";
          }

          if (thousand > 0) {
            result += convertChunk(thousand) + " THOUSAND ";
          }

          if (remainder > 0) {
            result += convertChunk(remainder);
          }

          return "RUPEES " + result.trim() + " ONLY";
        }

        //today date function
        const todayDate = () => {
          const monthName = {
            1: "Jan",
            2: "Feb",
            3: "Mar",
            4: "Apr",
            5: "May",
            6: "Jun",
            7: "Jul",
            8: "Aug",
            9: "Sep",
            10: "Oct",
            11: "Nov",
            12: "Dec",
          };
          const today = new Date();

          const day = today.getDate();
          const month = today.getMonth() + 1;
          const year = today.getFullYear();

          const formattedDate =
            (day < 10 ? "0" : "") + day + "-" + monthName[month] + "-" + year;

          return formattedDate;
        };

        const studentHtml = document.getElementById("studentsList");
        studentHtml.innerHTML = ``;
        multipleStudents?.forEach((element) => {
          const feeDetails = element?.contentRequest;
          console.log(element, "sssssssssssss");

          const singleStudentHtml = document.createElement("div");
          singleStudentHtml.style.pageBreakAfter = "always";
          singleStudentHtml.innerHTML = `

          <style type="text/css">
   @page {
   size: A4
   }
   * {
   margin: 0px;
   padding: 0px;
   color: #000;
   }
   td {
   padding-left: 1mm;
   padding-right: 1mm;
   padding-top: 0.5mm;
   padding-bottom: 0.2mm;
   font-size: 9pt;
   color: #000000;
   font-family: math;
   }
   th {
   padding-left: 1mm;
   padding-right: 1mm;
   padding-top: 0.5mm;
   padding-bottom: 0.2mm;
   background: #e7e7e7;
   font-family: math;
   }
   .signImg {
   width: 150px;
   height: auto;
   }
   @media print {
   @page {
   margin:7mm;
   size: A4
   }
   .signImg {
   width: 150px;
   height: auto;
   }
   }
</style>
       
<page orientation="portrait" format="A4" margin="0">
   <!--content area-->
   <!-- Spacing -->
   <table cellspacing="0" style="width:100%;">
      <tr>
         <td style="padding-left:0mm; padding-right:0mm; padding-top:18mm; padding-bottom:15mm;">
            <div style="height:5mm;">&nbsp;</div>
         </td>
      </tr>
   </table>
   <!-- Spacing -->
   <table style="width: 100%;">
      <tbody>
         <tr valign="top">
            <td valign="top" style=" width:100%; padding-left:0mm; padding-right:0mm; padding-top:0mm; padding-bottom:0mm;">
               <!-- Header Section -->
               <table style="width:100%;" cellspacing="0" cellpadding="0">
                  <tbody>
                     <tr>
                        <td align="left" style="width:23%; padding-top:0mm; padding-bottom:0mm; ">
                           <span style="font-size:10pt; text-transform:uppercase; padding-top:0mm;">(Admission No. ${
                             feeDetails?.studentId
                           } )</span>
                        </td>
                        <td align="center" style="width:54%; padding-top:0mm; padding-bottom:m;">
                        </td>
                        <td align="right" style="padding-left:0mm; width:23%; padding-right:0mm; padding-top:0mm; padding-bottom:0mm; font-size:10pt; font-family: math; text-align:right; ">${todayDate()}</td>
                     </tr>
                     <tr>
                        <td align="left" style="width:23%; padding-top:0mm; padding-bottom:0mm; ">
                        </td>
                        <td align="center" style="width:54%; padding-top:5mm; padding-bottom:5mm;">
                           <span style="font-size:20pt; border-bottom: solid 0.3mm #000000; text-transform:uppercase; font-family: math;">TO WHOM IT MAY CONCERN</span>
                        </td>
                        <td align="right" style="width:23%; padding-top:0mm; padding-bottom:0mm; ">
                        </td>
                     </tr>
                  </tbody>
               </table>
               <!-- Header Section -->
               <table cellspacing="0" style="width:100%;">
                  <tr>
                     <td style="padding-left:0mm; padding-right:0mm; padding-top:0mm; padding-bottom:0mm;">
                        <div style="height:3mm;">&nbsp;</div>
                     </td>
                  </tr>
               </table>
               <!--// Basic Details -->
               <!-- Certificate -->
               <table cellspacing="0" style="width:100%;">
                  <tr>
                     <td style="width:100%; font-size:14pt">
                        <table width="100%" style="width:100%;" cellspacing="0" cellpadding="0">
                           <tbody>
                              <tr>
                              <td style="width:25%; padding-top:0mm; padding-bottom:0mm;">
                                 <span style="font-size:14pt;">This is to certify that</span>
                              </td>
                              <td style="width:75%; padding-top:0mm; padding-bottom:0mm; border-bottom: solid 0.4mm #000000;">
                                 <span style="font-size:14pt; text-transform:uppercase;">&nbsp;${
                                   feeDetails?.studentName
                                 }</span>
                              </td>
                           </tr>
                        </tbody></table>
                     </td>
                  </tr>
                  <tr>
                     <td style="width:100%; font-size:14pt">
                        <table width="100%" style="width:100%;" cellspacing="0" cellpadding="0">
                           <tr>
                              <td  style="width:100%; padding-top:0mm; padding-bottom:0mm; justify-content: space-between;">
                                 <span style="font-size:14pt; font-family: math; line-height: 35px;">S/o. <span style="text-transform: uppercase;">${
                                   feeDetails?.fatherName
                                 }</span> is/was studying in - <span style="text-transform: uppercase;">[${
            feeDetails?.studentClass
          },${feeDetails?.studentSection}]</span> During the Financial Year - ${
            feeDetails?.session
          } a sum of Rs. ${
            feeDetails?.totalAmount
          } <span style="text-transform: uppercase;">(${convertNumberToWords(
            feeDetails?.totalAmount
          )})</span> ,is/was paid as per details as under :</span>
                              </td>
                           </tr>
                        </table>
                     </td>
                  </tr>
               </table>
               <!--  -->
               <table cellspacing="0" style="width:100%;">
                  <tr>
                     <td style="padding-left:0mm; padding-right:0mm; padding-top:1mm; padding-bottom:1mm;">
                        <div style="height:2mm;">&nbsp;</div>
                     </td>
                  </tr>
               </table>
               <!--  -->
               <table cellspacing="0" style="width:100%;">
                  <tbody>
                     <tr>
                        <td align="center">
                           <table cellspacing="0" style="width:100%; border-top: solid 0.3mm #000000; border-left: solid 0.3mm #000000;">
                              <tbody>
                                 <tr>
                                    <td align="left" style="width:10%; font-size:14pt; font-family: math; border-bottom: solid 0.3mm #000000; border-right: solid 0.3mm #000000;">&nbsp;<strong>MONTHS</strong>&nbsp;</td>
                                    <td align="left" style="width:30%; font-size:14pt; font-family: math; border-bottom: solid 0.3mm #000000; border-right: solid 0.3mm #000000;">&nbsp;<strong>COMPONENT</strong>&nbsp;</td>
                                    <td align="right" style="width:30%; font-size:14pt; font-family: math; border-bottom: solid 0.3mm #000000; border-right: solid 0.3mm #000000;">&nbsp;<strong>AMOUNT</strong>&nbsp;</td>
                                    <td align="left" style="width:20%; font-size:14pt; font-family: math; border-bottom: solid 0.3mm #000000; border-right: solid 0.3mm #000000;">&nbsp;<strong>DATE OF</strong>&nbsp;</td>
                                 </tr>
                                 <tr>
                                    <td align="left" style="width:20%; font-size:12pt; font-family: math; border-bottom: solid 0.3mm #000000; border-right: solid 0.3mm #000000;">&nbsp;&nbsp;</td>
                                    <td align="left" style="width:30%; font-size:12pt; font-family: math; border-bottom: solid 0.3mm #000000; border-right: solid 0.3mm #000000; text-transform: uppercase;">&nbsp;&nbsp;</td>
                                    <td align="right" style="width:30%; font-size:12pt; font-family: math; border-bottom: solid 0.3mm #000000; border-right: solid 0.3mm #000000;">&nbsp;<strong>(Rs.)</strong>&nbsp;</td>
                                    <td align="left" style="width:20%; font-size:12pt; font-family: math; border-bottom: solid 0.3mm #000000; border-right: solid 0.3mm #000000;">&nbsp;<strong>PAYMENT</strong>&nbsp;</td>
                                 </tr>
                                 ${feeDetails?.studentFeeCertificateInstallmentResponse
                                   ?.map(
                                     (record) => `
                                  <tr>
                                    <td align="left" style="width:20%; font-size:10pt; font-family: math; border-bottom: solid 0.3mm #000000; border-right: solid 0.3mm #000000;">&nbsp;${record?.installmentName}&nbsp;</td>
                                    <td align="left" style="width:30%; font-size:10pt; font-family: math; border-bottom: solid 0.3mm #000000; border-right: solid 0.3mm #000000; text-transform: uppercase;">&nbsp;${feeDetails?.componentName}&nbsp;</td>
                                    <td align="right" style="width:30%; font-size:10pt; font-family: math; border-bottom: solid 0.3mm #000000; border-right: solid 0.3mm #000000;">&nbsp;${record?.amount}&nbsp;</td>
                                    <td align="left" style="width:20%; font-size:10pt; font-family: math; border-bottom: solid 0.3mm #000000; border-right: solid 0.3mm #000000;">&nbsp;${record?.feeDate}&nbsp;</td>
                                    </tr>
                                    `
                                   )
                                   .join("")}
                                
                              </tbody>
                           </table>
                        </td>
                     </tr>
                  </tbody>
               </table>
               <!--  -->
               <table cellspacing="0" style="width:100%;">
                  <tr>
                     <td colspan="3" align="right" style="width:80%; font-size:12pt; height:12mm; font-family: math;">&nbsp;Total Rs : ${
                       feeDetails?.totalAmount
                     }&nbsp;</td>
                     <td align="left" style="width:20%; height:12mm; font-size:12pt; font-family: math;">&nbsp;&nbsp;</td>
                  </tr>
               </table>
               
               <table cellspacing="0" style="width:100%;">
                  <tr>
                     <td style="width:100%; font-size:14pt">
                        <table width="100%" style="width:100%;" cellspacing="0" cellpadding="0">
                           <tr>
                              <td  style="width:100%; padding-top:0mm; padding-bottom:0mm; justify-content: space-between;">
                                 <span style="font-size:14pt; font-family: math; line-height: 35px;">Certified that the school is recognized by the Directorate of Education vide Recognition No. <span style="text-transform: uppercase;">DE 15(79)/ACT-1/2014/85-95</span> dated 8/4/2015. CBSE AFFILIATION CODE - 2730770 - /</span>
                              </td>
                           </tr>
                        </table>
                     </td>
                  </tr>
                  <tr>
                     <td style="width:100%; font-size:11pt">
                        <table width="100%" style="width:100%;" cellspacing="0" cellpadding="0">
                           <tr>
                              <td  style="width:100%; padding-top:0mm; padding-bottom:0mm; justify-content: space-between;">
                                 <span style="font-size:14pt; font-family: math; line-height: 35px;">This certificate is being issued to <span style="text-transform: uppercase;">${
                                   feeDetails?.fatherName
                                 }</span> for claiming rebate under the provision of Income Tax Act,1961 / reimbursement from the concerned department.</span>
                              </td>
                           </tr>
                        </table>
                     </td>
                  </tr>
               </table>
               <!--  -->
               <!-- footer -->
               <table cellspacing="0" style="width:100%;">
                  <tr>
                     <td style="padding-left:0mm;; padding-right:0mm; padding-top:20mm; padding-bottom:0mm; line-height:130%; font-size:14pt; text-align:left; font-family: math; text-align: right;"><strong>Head of School</strong></td>
                  </tr>
               </table>
               <!-- footer -->
            </td>
         </tr>
      </tbody>
   </table>
   <!--  -->
   <!--// content area-->
</page>`;

          studentHtml.appendChild(singleStudentHtml);
        });
      };
    </script>
    <script>
      window.SetTemplateData([
        {
          contentRequest: {
            studentId: "1855",
            studentName: "Chahak",
            studentClass: "IX",
            studentSection: "A",
            fatherName: "Sandeep Mittal",
            motherName: "Sonia Mittal",
            componentName: "'Annual fee','Monthly Fee'",
            session: "2024-2025",
            gender: "Female",
            studentFeeCertificateInstallmentResponse: [
              {
                installmentName: "January",
                amount: 150.0,
                feeDate: "2024-02-20",
              },
            ],
            totalAmount: 150.0,
          },
          header: `
          <table style="width:100%;" cellspacing="0" cellpadding="0">
                  <tbody>
                     <tr>
                        <td valign="top" rowspan="2" align="left" style="width:10%; padding-top:0mm; padding-bottom:0mm;"><img align="left" style="width: 140px;" src="https://quickcampus-webcms-dev.s3.ap-south-1.amazonaws.com/DIPS653/school-logo.png"></td>
                        <td align="center" style="width:80%; padding-top:0mm; padding-bottom:1mm;">
                           <span style="color:#0089e0; font-size:54pt; text-transform:uppercase; font-weight:bold; padding-top:4mm; font-family: ui-sans-serif;">DE&nbsp;INDIAN</span> 
                           <br>
                           <span style="color:#0089e0; font-size:26pt; text-transform:uppercase; font-weight:bold; font-family: ui-sans-serif;">PUBLIC&nbsp;SCHOOL</span>
                        </td>
                        <td valign="middle" rowspan="2" align="left" style="width:10%; padding-top:0mm; padding-bottom:0mm; ">
                           <span style="color: #000000; font-weight:bold; font-size:10pt; line-height: 140%; text-transform:uppercase;">School&nbsp;Copy</span>
                        </td>
                     </tr>
                     <tr>
                        <td align="center" style="width:85%; font-size:10pt; font-weight:bold; padding-top:0mm; padding-bottom:0mm;">
                           <table cellspacing="0" style="width:100%;">
                              <tbody>
                                 <tr>
                                    <td style="width:10%;">&nbsp;</td>
                                    <td align="center" style="width:80%; border-top: solid 0.264583333mm #000000; font-weight:bold; font-size:14pt; text-transform:uppercase;">Give WINGS TO YOUR DREAMS
                                    </td>
                                    <td style="width:10%;">&nbsp;</td>
                                 </tr>
                                 <tr>
                                    <td style="width:10%;">&nbsp;</td>
                                    <td align="center" style="width:80%; font-weight:bold; font-size:14pt;">
                                       <span style="color: #000000; font-weight:bold; font-size:10pt; line-height: 140%;">POCKET-11, SECTOR-24, ROHINI, DELHI-110085 <br>
                                       27050252 <br>
                                       www.dipsrohini.in, rohini.dips@yahoo.co.in</span>
                                    </td>
                                    <td style="width:10%;">&nbsp;</td>
                                 </tr>
                              </tbody>
                           </table>
                        </td>
                     </tr>
                  </tbody>
               </table>
    `,
          footer:
            '<page_footer>\n <table style="padding:2mm 0mm 0mm;" cellspacing="0" cellpadding="0">\n  <tbody>\n   <tr>\n    <td style="padding:0mm;width:100%;" width="100%" align="left" valign="top"><strong>Note</strong>: This is a computer generated report and does not require signatures.</td>\n   </tr>\n  </tbody>\n </table>\n</page_footer>',
        },
      ]);
    </script>
  </body>
</html>
