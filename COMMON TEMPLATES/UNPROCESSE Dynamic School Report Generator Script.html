<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>UNPROCESSED Dynamic School Report Generator Script</title>
</head>

<body>
    <div id="studentsList">UNPROCESSED Dynamic School Report Generator Script</div>
    <script>


        // Main function to set template data
        window.SetTemplateData = function (dataList) {
            // CSS Styles
            const styles = `
    <style type="text/css">
        body {
            font-family: Arial, sans-serif;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid black; 
        }

        th, td {
            border: 1px solid black;
            padding: 2px;
            text-align: left;
            font-size: 12px;
        }

        h3 {
            margin: 3px 0px;
            padding: 0px;
            font-size: 13px;
        }

        h5 {
            padding: 0px;
            margin: 5px;
        }

        .header {
            text-align: center;
            font-weight: bold;
            margin: 5px 0;
        }

        .page {
            page-break-after: always;
            break-after: page;
        }

        .section {
            margin-bottom: 10px;
        }

        @media print {
            @page {
                margin: auto;
                size: A4;
                margin: 2mm;
            }

            .page {
                page-break-after: always;
            }
        }
    </style>
`;

            const config = {
                schoolLogo:
                    "https://quickcampus-webcms-dev.s3.ap-south-1.amazonaws.com/QC/web-content/event/images/UploadFile2024-08-07T10_48_06_661575730.png",
                schoolAddress: "123 School Street, City, Country",
                schoolPlace: "City Name",
                scholasticType: "Theory",
                coScholasticType: "1B Scholastic",
                computerScienceSubject: "COMPUTER SCIENCE",
                subParentGrade: [
                    "LISTENING SKILLS",
                    "Activity",
                    "Mental Maths",
                    "Unit I",
                    "Unit II",
                    "Activity Project",
                    "Group Discussion",
                ],
                attendanceValues: {
                    Absent: "AB",
                    Medical: "M",
                    Sports: "S",
                    Leave: "L",
                    "Late Admission": "LA",
                    Exempted: "EX",
                    NA: "NA",
                },
                showMarks: false, // Set to true if you want to display marks instead of grades
            };

            const multiData = Array.isArray(dataList) ? dataList : [dataList];
            const viewTemplate = multiData[0]?.viewTemplate;
            const staticData = [
                {
                    student: {
                        dob: "11-02-2019",
                        admissionNo: "7378",
                        studentName: "Eklavya Jadwani Static data",
                        className: "PRE SCHOOL",
                        sectionName: "A",
                        rollNo: 1,
                        fatherName: "Mohit Jadwani",
                        motherName: "Sonal Jadwani",
                        attendance: "0.0/0",
                        boardRollNumber: "",
                        studentInfoResponse: [
                            {
                                id: 173828,

                                studentId: "7378",
                                studentName: "Eklavya Jadwani",
                                fatherName: "Mohit Jadwani",
                                motherName: "Sonal Jadwani",
                                dob: "11-02-2019",
                                gender: "Male",
                                studentAdhaarcard: "665567651279",
                                joiningClass: "PRE SCHOOL",
                                joiningSections: "A",
                                joiningDate: "04-01-2023",

                                area: "Shalimar Bagh",
                                city: "Delhi",
                                state: "Delhi",
                                pincode: "110088",

                                rollNo: 1,

                                mobileNumber: "9910201369",

                                minority: "No",

                                bloodGroup: "O+",

                                siblingResponse: [],

                                fatherOrganization: "Abce",

                                fatherPincode: "111111",

                                fatherMobile: "9910201369",

                                fatherAdhaarNumber: "556473647875",

                                motherOrganization: "Abce",

                                motherPincode: "111111",

                                motherMobile: "9910201369",

                                motherAdhaarNumber: "657483551325",

                                otp: "L1PNK2",
                                schoolName: "Demo Public School",

                                classes: "PRE SCHOOL",

                                sections: "A",

                                wing: "Senior",
                                status: "Studying",
                                academicSession: "2023-2024",
                                joiningStatus: "New",

                                certificatesList: [],

                                attached: false,
                                required: false,
                                submitted: false,
                                studentHostel: [],
                                studentConcession: [],
                                studentTransport: [],

                                createdUser: "indian1234",
                                editedUser: "indian1234",
                                createddate: "2023-09-13 12:22:53.630549",
                                editeddate: "2023-09-13 12:22:53.630549",
                                studentAddressResponse: {
                                    area: "Shalimar Bagh",

                                    city: "Delhi",

                                    state: "Delhi",

                                    pincode: 110088,
                                    street: "Cb-8c",
                                    userName: "DIPST279_7378",
                                    createdDate: "13-09-2023 05:52 PM",
                                    editedDate: "13-09-2023 05:52 PM",
                                    createdBy: "indian1234",
                                    editedBy: "indian1234",
                                },
                                fatherAddressResponse: {
                                    pincode: 111111,

                                    userName: "DIPST279_F7378",
                                    createdDate: "13-09-2023 05:52 PM",
                                    editedDate: "13-09-2023 05:52 PM",
                                    createdBy: "indian1234",
                                    editedBy: "indian1234",
                                },
                                motherAddressResponse: {
                                    pincode: 111111,

                                    userName: "DIPST279_M7378",
                                    createdDate: "13-09-2023 05:52 PM",
                                    editedDate: "13-09-2023 05:52 PM",
                                    createdBy: "indian1234",
                                    editedBy: "indian1234",
                                },
                            },
                        ],
                    },
                    markData: {
                        admissionNo: "20220031",

                        studentName: "Angel",
                        className: "I",
                        sectionName: "A",

                        academicSession: "2024-2025",
                        fatherName: "Vikas Bhardwaj",

                        pass: false,
                        rollNo: 0,
                        termWiseSubjectResponse: [
                            {
                                totalMarks: 4700,
                                totalObtained: 2059.7400000000002,
                                overAllGrade: "C2",
                                totalPercentage: 43.82425531914894,
                                termName: "CYCLE I",

                                pass: true,
                                subjectMarksEntryRequests: [
                                    {
                                        marks: 100,

                                        subject: "4098c6f9-a43c-49bd-9464-9c30595c6bad",
                                        subjectName: "ENGLISH",
                                        scholastic: true,
                                        max: 100,
                                        priority: 1,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: [],
                                        grade: "A1",
                                        percentage: 100,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 90.99,

                                        subject: "bf4353a5-2ce3-4c57-b8e2-ca88c48b55cf",
                                        subjectName: "READING SKILLS",
                                        scholastic: true,
                                        max: 100,
                                        priority: 2,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["ENGLISH"],
                                        grade: "A2",
                                        percentage: 90.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 80.99,

                                        subject: "a19bce9e-c1f0-41c0-bf73-06f2bb3ba758",
                                        subjectName: "Pronunciation and Fluency",
                                        scholastic: true,
                                        max: 100,
                                        priority: 3,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["READING SKILLS", "ENGLISH"],
                                        grade: "B1",
                                        percentage: 80.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 70.99,

                                        subject: "52924be7-6829-4611-ad04-ea1f49535f94",
                                        subjectName: "Comprehension",
                                        scholastic: true,
                                        max: 100,
                                        priority: 4,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["READING SKILLS", "ENGLISH"],
                                        grade: "B2",
                                        percentage: 70.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 60.99,

                                        subject: "f14285be-3908-482e-af32-df2c58b783bf",
                                        subjectName: "WRITING SKILLS",
                                        scholastic: true,
                                        max: 100,
                                        priority: 5,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["ENGLISH"],
                                        grade: "C1",
                                        percentage: 60.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 50.99,

                                        subject: "6dd41b24-d089-4179-9722-f0d6822cc646",
                                        subjectName: "Spellings and Vocabulary",
                                        scholastic: true,
                                        max: 100,
                                        priority: 6,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["WRITING SKILLS", "ENGLISH"],
                                        grade: "C2",
                                        percentage: 50.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 40.99,

                                        subject: "e903cb68-b44b-4570-836d-8fab8d897eff",
                                        subjectName: "Handwriting",
                                        scholastic: true,
                                        max: 100,
                                        priority: 7,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["WRITING SKILLS", "ENGLISH"],
                                        grade: "D",
                                        percentage: 40.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 32.99,

                                        subject: "6979a242-1846-43f9-964e-67df839f8ff5",
                                        subjectName: "Unit I",
                                        scholastic: true,
                                        max: 100,
                                        priority: 8,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["WRITING SKILLS", "ENGLISH"],
                                        grade: "E",
                                        percentage: 32.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Absent",
                                        subject: "187ef110-eab5-4b03-9000-560aba59769a",
                                        subjectName: "Unit II",
                                        scholastic: true,
                                        max: 100,
                                        priority: 9,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["WRITING SKILLS", "ENGLISH"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Medical",
                                        subject: "3c9539ca-ff69-46d6-b1b1-597b2a60e0f6",
                                        subjectName: "SPEAKING SKILLS",
                                        scholastic: true,
                                        max: 100,
                                        priority: 10,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["ENGLISH"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Sports",
                                        subject: "df62b7d9-76c6-4d20-9658-0e5f91d898e0",
                                        subjectName: "Conversation",
                                        scholastic: true,
                                        max: 100,
                                        priority: 11,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["SPEAKING SKILLS", "ENGLISH"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Leave",
                                        subject: "59102af4-37c2-417c-87e6-1df875cafcd0",
                                        subjectName: "Recitation",
                                        scholastic: true,
                                        max: 100,
                                        priority: 12,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["SPEAKING SKILLS", "ENGLISH"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Late Admission",
                                        subject: "30dad93c-4119-4bd8-9a24-883548997836",
                                        subjectName: "LISTENING SKILLS",
                                        scholastic: true,
                                        max: 100,
                                        priority: 13,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["ENGLISH"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 90.99,

                                        subject: "833b18f6-5ec6-4f69-94b8-705889cd32ba",
                                        subjectName: "HINDI",
                                        scholastic: true,
                                        max: 100,
                                        priority: 14,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: [],
                                        grade: "A2",
                                        percentage: 90.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 70.99,

                                        subject: "7aa6dced-4045-451e-ae64-611837d6d9d0",
                                        subjectName: "READING SKILLS",
                                        scholastic: true,
                                        max: 100,
                                        priority: 15,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["HINDI"],
                                        grade: "B2",
                                        percentage: 70.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 60.99,

                                        subject: "28293cf8-3f2b-4a76-a5cb-68b3a05aef71",
                                        subjectName: "Pronunciation and Fluency",
                                        scholastic: true,
                                        max: 100,
                                        priority: 16,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["READING SKILLS", "HINDI"],
                                        grade: "C1",
                                        percentage: 60.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 60.99,

                                        subject: "d4ea80d9-28ec-4550-a588-c3c1ad1105ee",
                                        subjectName: "Comprehension",
                                        scholastic: true,
                                        max: 100,
                                        priority: 17,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["READING SKILLS", "HINDI"],
                                        grade: "C1",
                                        percentage: 60.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 70.99,

                                        subject: "71e1cd3b-33cc-40df-940d-2e7feb14bdc0",
                                        subjectName: "WRITING SKILLS",
                                        scholastic: true,
                                        max: 100,
                                        priority: 18,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["HINDI"],
                                        grade: "B2",
                                        percentage: 70.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 60.99,

                                        subject: "c383c113-06c0-46af-a029-6a79e2dc41f2",
                                        subjectName: "Spellings and Vocabulary",
                                        scholastic: true,
                                        max: 100,
                                        priority: 19,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["WRITING SKILLS", "HINDI"],
                                        grade: "C1",
                                        percentage: 60.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Medical",
                                        subject: "a0d62b85-135e-4102-89a7-b050f9831521",
                                        subjectName: "Handwriting",
                                        scholastic: true,
                                        max: 100,
                                        priority: 20,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["WRITING SKILLS", "HINDI"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Medical",
                                        subject: "dce7a013-acf2-403d-81b3-18c005e173d9",
                                        subjectName: "Unit I",
                                        scholastic: true,
                                        max: 100,
                                        priority: 21,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["WRITING SKILLS", "HINDI"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Leave",
                                        subject: "91d01f38-20f8-4e22-994c-e71ffda8a45e",
                                        subjectName: "Unit II",
                                        scholastic: true,
                                        max: 100,
                                        priority: 22,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["WRITING SKILLS", "HINDI"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Medical",
                                        subject: "885b29f5-25b9-4bd4-ac78-6006f228f198",
                                        subjectName: "SPEAKING SKILLS",
                                        scholastic: true,
                                        max: 100,
                                        priority: 23,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["HINDI"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Absent",
                                        subject: "5052153c-ab38-40cc-93c5-0291b9eb79d2",
                                        subjectName: "Conversation",
                                        scholastic: true,
                                        max: 100,
                                        priority: 24,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["SPEAKING SKILLS", "HINDI"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Late Admission",
                                        subject: "6da3741f-51a1-47ea-a942-087ea8136e7e",
                                        subjectName: "Recitation",
                                        scholastic: true,
                                        max: 100,
                                        priority: 25,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["SPEAKING SKILLS", "HINDI"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Sports",
                                        subject: "991e64bc-ec80-4662-9c05-05e6329236da",
                                        subjectName: "LISTENING SKILLS",
                                        scholastic: true,
                                        max: 100,
                                        priority: 26,
                                        min: 0,

                                        subjectNature: "Theory",
                                        parent: ["HINDI"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },

                                    {
                                        marks: 70.99,

                                        subject: "727045f1-63de-4dee-9fbd-8fe85bf11cf9",
                                        subjectName: "ASPECTS",
                                        scholastic: true,
                                        max: 100,
                                        priority: 37,
                                        min: 0,

                                        subjectNature: "1B Scholastic",
                                        parent: [],
                                        grade: "B2",
                                        percentage: 70.99,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Absent",
                                        subject: "69a4b869-c1e4-4c76-9aa8-ffff01c6b447",
                                        subjectName: "COMPUTER SCIENCE",
                                        scholastic: true,
                                        max: 100,
                                        priority: 38,
                                        min: 0,

                                        subjectNature: "1B Scholastic",
                                        parent: [],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Medical",
                                        subject: "49f053a1-2aff-422c-8587-06f1c41d1064",
                                        subjectName: "SPORTS",
                                        scholastic: true,
                                        max: 100,
                                        priority: 39,
                                        min: 0,

                                        subjectNature: "1B Scholastic",
                                        parent: [],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Leave",
                                        subject: "358b87df-d7a2-4b72-8abe-3ab0de1287b0",
                                        subjectName: "Team Spirit",
                                        scholastic: true,
                                        max: 100,
                                        priority: 40,
                                        min: 0,

                                        subjectNature: "1B Scholastic",
                                        parent: ["SPORTS"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                    {
                                        marks: 0,

                                        status: "Sports",
                                        subject: "c3301ab7-8a04-40d2-8d63-3f6aa0c2c257",
                                        subjectName: "Talent",
                                        scholastic: true,
                                        max: 100,
                                        priority: 41,
                                        min: 0,

                                        subjectNature: "1B Scholastic",
                                        parent: ["SPORTS"],
                                        grade: "E",
                                        percentage: 0,
                                        term: "CYCLE I",

                                        pass: true,
                                        gradePattern: "USA 8 POINT",
                                        graded: true,
                                    },
                                ],
                            },
                        ],
                    },

                    remarks: {
                        terms: ["CYCLE-I"],
                        studentId: "14969",
                        studentName: "Riyana Jain",
                        rollNumber: 31,

                        classSection: "I-A",
                        description: "VERY GOOD",
                        fields: [
                            {
                                title: "SPECIFIC PARTICIPATION",
                                type: "OPEN",
                                value: "HI HELLO HOW ARE YOU",

                                masterName: "SPECIFIC PARTICIPATION",
                            },
                            {
                                title: "Session Date",
                                type: "ALPHA_NUMERIC",

                                masterName: "NEW SESSION BEGINS ON",
                            },
                            {
                                title: "TEACHER REMARK",
                                type: "ALPHABETS_WITH_SPECIAL",

                                masterName: "REMARKS",
                            },
                            {
                                title: "TOTAL ATTENDANCE",
                                type: "NUMERIC",
                                value: "120",

                                masterName: "ATTENDANCE",
                            },
                        ],
                        status: true,
                        createdUser: "QuickCampus",
                        editedUser: "QuickCampus",
                        createdDate: "31-01-2024 01:03 PM",
                        editedDate: "31-01-2024 01:03 PM",
                    },
                    header: `<div>
                <table style="width:100%;" cellspacing="0" cellpadding="0">
                                        <tbody>
                                            <tr>
                                                <td valign="middle" align="left" style="width:10%; padding-top:0mm; padding-bottom:0mm;">
                                                    &nbsp;
                                                </td>
                                                <td align="middle" style="width:80%; padding-top:0mm; padding-bottom:0mm;">
                                                    <span style="font-size:10pt; text-transform:uppercase; padding-top:0mm; padding-bottom:0mm; ">SHREE JI WORLD SCHOOL</span>
                                                    <br>
                                                    <span style="width:80%; padding-top:0mm; padding-bottom:0mm; font-size:10pt; text-transform:uppercase; ">GURUDWARA LANE, JAIN COLONY, NANESH ENCLAVE,PREHLADPUR, KHERA, OPP. SECTOR 30, ROHINI, DELHI-110042</span>
                                                </td>
                                               
                                            </tr>
                                        </tbody>
                                    </table>

         </div>`,
                },
            ];

            const data = viewTemplate ? staticData : multiData;

            // Function to process subject data
            function processSubjectData(data, subjectType) {
                // console.log(data, subjectType, "ffffffffffffffffff data")
                let subjects = {
                    main: [],
                    sub: {},
                    children: {},
                };
                let terms = [];

                data.forEach((el) => {
                    // console.log(el, "fffffffffff el")
                    el?.markData?.termWiseSubjectResponse?.forEach((td) => {
                        // console.log(td, "fffffffffff td")
                        terms.push(td.termName);
                        td.subjectMarksEntryRequests
                            ?.filter((s) => s.subjectNature === subjectType)
                            .forEach((s) => {
                                // console.log(s, "fffffffffff s")
                                processSubject(s, td.termName, subjects);
                            });
                    });
                });

                return { subjects, terms: [...new Set(terms)] };
            }

            // Helper function to process individual subjects
            function processSubject(s, termName, subjects) {
                if (!s.parent || s.parent.length === 0) {
                    addSubject(subjects.main, s, termName);
                } else if (s.parent.length === 1) {
                    if (!subjects.sub[s.parent[0]]) subjects.sub[s.parent[0]] = [];
                    addSubject(subjects.sub[s.parent[0]], s, termName);
                } else if (s.parent.length === 2) {
                    const key = `${s.parent[1]}-${s.parent[0]}`;
                    if (!subjects.children[key]) subjects.children[key] = [];
                    addSubject(subjects.children[key], s, termName);
                }
            }

            // Helper function to add or update a subject
            function addSubject(array, s, termName) {
                let subject = array.find(
                    (item) => item.subjectName === s.subjectName
                );
                if (!subject) {
                    subject = {
                        subjectName: s.subjectName,
                        grade: {},
                        status: {},
                        marks: {},
                    };
                    array.push(subject);
                }
                subject.grade[termName] = s.grade;
                subject.status[termName] = s.status;
                subject.marks[termName] = s.marks;
            }

            const scholasticData = processSubjectData(data, config.scholasticType);
            console.log(scholasticData, "fffffffffffffff scholasticData");

            const coScholasticData = processSubjectData(
                data,
                config.coScholasticType
            );
            console.log(coScholasticData, "fffffffffffffff coScholasticData");

            // Generate HTML for subjects
            function generateSubjectHTML(subjectData, isScholastic) {
                let html = "";
                subjectData.subjects.main.forEach((main, i) => {
                    console.log(main, "ffffffffffffff main");
                    html += `
                <div class="section">
                    <table>
                        <tr>
                            <th colspan="2" style="text-align:left; ">${main.subjectName
                        }</th>
                            ${subjectData.terms
                            .map(
                                (t) => `
                                <th style="width: 100px; text-align:center; ">
                                    ${isScholastic
                                        ? "GRADE"
                                        : main.subjectName ===
                                            config.computerScienceSubject
                                            ? main.grade[t]
                                            : "GRADE"
                                    }
                                </th>
                            `
                            )
                            .join("")}
                        </tr>
                        ${generateSubSubjectsHTML(
                                subjectData.subjects.sub[main.subjectName],
                                subjectData.subjects.children,
                                main.subjectName,
                                subjectData.terms,
                                isScholastic
                            )}
                    </table>
                </div>
            `;
                });
                return html;
            }

            // Generate HTML for sub-subjects and their children
            function generateSubSubjectsHTML(
                subSubjects,
                children,
                parentSubject,
                terms,
                isScholastic
            ) {
                let html = "";
                (subSubjects || []).forEach((sub, index) => {
                    html += `
                <tr>
                    <td style="text-align:center; font-weight:bold">${index + 1
                        }</td>
                    <td><strong>${sub.subjectName}</strong></td>
                    ${terms
                            .map(
                                (t) => `
                        <td style="width: 100px; text-align:center;">
                            ${renderGradeOrStatus(sub, t, isScholastic)}
                        </td>
                    `
                            )
                            .join("")}
                </tr>
            `;
                    html += generateChildSubjectsHTML(
                        children[`${parentSubject}-${sub.subjectName}`],
                        terms,
                        isScholastic
                    );
                });
                return html;
            }

            // Generate HTML for child subjects
            function generateChildSubjectsHTML(childSubjects, terms, isScholastic) {
                return (childSubjects || [])
                    .map(
                        (child) => `
            <tr>
                <td style="text-align:center;"></td>
                <td>&nbsp;&nbsp;&nbsp;&nbsp;*${child.subjectName}</td>
                ${terms
                                .map(
                                    (t) => `
                    <td style="text-align:center; width: 100px;">
                        ${renderGradeOrStatus(child, t, isScholastic)}
                    </td>
                `
                                )
                                .join("")}
            </tr>
        `
                    )
                    .join("");
            }

            // Helper function to render grade or status
            function renderGradeOrStatus(subject, term, isScholastic) {
                if (subject.status[term]) {
                    const status = config.attendanceValues[subject.status[term]] || "-";
                    if (status === "-") {
                        return status;
                    } else {
                        return `<strong>${status}</strong>`; // For other status types like "AB", "M", etc.
                    }
                }

                if (
                    isScholastic &&
                    config.subParentGrade.includes(subject.subjectName)
                )
                    return subject.grade[term] || "-";
                return (

                    (config.showMarks ? subject.marks[term] || "-" : subject.grade[term] || "-")
                );
            }

            // Generate HTML for the entire report
            function generateReportHTML(studentData) {
                const student = studentData.student;
                const markData = studentData.markData;
                const studentInfo = student.studentInfoResponse[0] || {};

                return `
            <div class="page">
                ${styles}
                ${generateHeaderHTML(data[0].markData, student)}
                ${generateStudentInfoHTML(student)}
                <h5>SCHOLASTIC AREAS</h5>
                <div style="display:grid; grid-template-columns: 1fr 1fr; grid-gap: 10px;">
                    ${generateSubjectHTML(scholasticData, true)}
                </div>
                <h5>CO-SCHOLASTIC AREAS</h5>
                ${generateSubjectHTML(coScholasticData, false)}
                ${generateRemarks(studentData, viewTemplate)}
                ${generateFooter(student, viewTemplate)}
            </div>
        `;
            }

            // Generate HTML for the header
            function generateHeaderHTML(markData, student) {
                return `
            <div class="header">
                <div style="height:60px;">
                    <img src="${config.schoolLogo}" alt="School Logo" style="height:100%;">  
                </div>
                <p style="font-size:12px; margin-top:-2px">${config.schoolAddress}</p>
                <p style="font-size:13px; margin-top:-10px">ACADEMIC SESSION-${markData.academicSession}</p> 
                <p style="font-size:13px; margin-top:-10px">${markData.termWiseSubjectResponse[0].termName}</p> 
                <p style="font-size:13px; margin-top:-15px">GRADE: ${student.className}</p>
            </div>
        `;
            }

            // Generate HTML for student information
            function generateStudentInfoHTML(student) {
                return `
            <table class="section" style="margin-top: -10px;">
                <tr>
                    <td style="width: 25%; font-weight:bold;">NAME</td>
                    <td style="width: 25%;">${student.studentName || "-"}</td>
                    <td style="width: 25%; font-weight:bold;">CLASS-SECTION</td>
                    <td style="width: 25%;">${student.className || "-"}</td>
                </tr>
                <tr>
                    <td style="font-weight:bold;">FATHER NAME</td>
                    <td>${student.fatherName || "-"}</td>
                    <td style="font-weight:bold;">ADMISSION NO.</td>
                    <td>${student.admissionNo || "-"}</td>
                </tr>
                <tr>
                    <td style="font-weight:bold;">MOTHER'S NAME</td>
                    <td>${student.motherName || "-"}</td>
                    <td style="font-weight:bold;">DATE OF BIRTH</td>
                    <td>${student.dob || "-"}</td>
                </tr>
            </table>
        `;
            }

            // Generate HTML for remarks
            function generateRemarks(studentData, viewTemplate) {
                return `
            <p style="margin-top: 2px; font-weight: bold; margin-bottom:0; font-size: 12px">SPECIFIC PARTICIPATION:</p>
            <div style="padding: 5px; border: 1px solid black; height: 20px;"></div>
            <p style="margin-top: 2px; font-weight: bold; margin-bottom:0; font-size: 12px">GENERAL REMARKS:</p>
            <div style="padding: 5px; border: 1px solid black; height: 20px; font-size: 12px">
                ${viewTemplate
                        ? "__________"
                        : studentData.remarks?.description || ""
                    }
            </div>
        `;
            }

            // Generate HTML for the footer
            function generateFooter(student, viewTemplate) {
                return `
            <div style="display:flex; justify-content: space-between; margin-top: 10px">
                <div style="display: flex;width: 30%; justify-content: space-left; border: 1px solid black;font-size:12px; padding: 2px;">
                    <span style="font-size:12px; font-weight:bold">ATTENDANCE:&nbsp;</span>${viewTemplate ? "__________" : student.attendance || ""
                    }
                </div>
                <div style="display: flex;width: 30%; justify-content: left; border: 1px solid black;font-size:12px; padding: 2px;">
                    <span style="font-size:12px;font-weight:bold">DATE:&nbsp;</span>
                    ${viewTemplate
                        ? "__________"
                        : new Date().toLocaleDateString("en-GB", {
                            year: "numeric",
                            month: "long",
                            day: "numeric",
                        })
                    }
                </div>
                <div style="display: flex;width: 30%; justify-content: left; border: 1px solid black;font-size:12px; padding: 2px;">
                    <span style="font-size:12px;font-weight:bold">PLACE:&nbsp;</span>${config.schoolPlace
                    }
                </div>
            </div>
            <div style="display: flex; justify-content: space-around; margin-top: 20px; font-size: 13px; margin-bottom: 0px">
                <div>
                    <p>${viewTemplate ? "__________" : ""}</p>
                    <p style="font-weight:bold">Class Incharge</p>
                </div>
                <div>
                    <p>${viewTemplate ? "__________" : ""}</p>
                    <p style="font-weight:bold">Headmistress</p>
                </div>
                <div>
                    <p>${viewTemplate ? "__________" : ""}</p>
                    <p style="font-weight:bold">Parent</p>
                </div>
            </div>
        `;
            }

            // Render the report for each student
            const studentsList = document.getElementById("studentsList");
            studentsList.innerHTML = "";
            data.forEach((studentData) => {
                let singleStudentHtml = document.createElement("div");
                singleStudentHtml.style.pageBreakBefore = "always";
                singleStudentHtml.innerHTML = generateReportHTML(studentData);
                studentsList.append(singleStudentHtml);
            });
        };
    </script>
</body>

<!-- Grade added data -->

<!-- marck added data -->

<script>
    window.SetTemplateData({ viewTemplate: true, header: "", footer: "" });
</script>

</html>